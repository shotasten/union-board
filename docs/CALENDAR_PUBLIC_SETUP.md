# Googleカレンダー公開設定手順

## 📋 概要

アプリで管理しているイベントカレンダーを、メンバーが自分のGoogleカレンダーに追加できるようにするための設定手順です。

---

## ⚠️ 重要: 実施前の確認

この設定により、**リンクを知っている人であれば誰でもカレンダーを閲覧できる**ようになります。

- ✅ メンバーがリンクを共有しやすい
- ✅ 検索エンジンには表示されない
- ⚠️ リンクが外部に漏れた場合、誰でも閲覧可能

**機密性の高いイベント情報がある場合は、この設定を行わないでください。**

---

## 🔧 設定手順

### 1. Googleカレンダーを開く

1. ブラウザで https://calendar.google.com/ にアクセス
2. GASスクリプトを実行しているGoogleアカウントでログイン

### 2. 対象カレンダーを探す

1. 左側のサイドバーで「他のカレンダー」セクションを探す
2. **「Tokyo Music Union イベントカレンダー」** を探す

![カレンダー一覧](※カレンダー名が表示されているはずです)

> **カレンダーが見つからない場合**:
> - GASの `setupBandCalendar()` 関数を実行してカレンダーを作成してください
> - または、Configシートの `CALENDAR_ID` を確認してください

### 3. カレンダーの設定を開く

1. 「Tokyo Music Union イベントカレンダー」にマウスを合わせる
2. 右側に表示される **「︙」（縦三点リーダー）** をクリック
3. **「設定と共有」** を選択

![設定メニュー](※設定メニューが表示されます)

### 4. アクセス権限を設定

1. 「設定と共有」画面で、下にスクロール
2. **「アクセス権限」** セクションを探す
3. 以下のいずれかを選択:

#### オプションA: カレンダーID方式（推奨）⭐

**この方法が最も簡単で確実です**

> **参考**: [Googleカレンダーの公式ヘルプ](https://support.google.com/calendar/answer/37082?hl=ja) によると、カレンダーを共有する方法は複数ありますが、カレンダーIDを使った方法が最も簡単です。

1. **「一般公開して誰でも利用できるようにする」のチェックは外したまま**にします
   - チェックを外す = カレンダーIDを知っている人のみが追加可能
   - チェックを入れる = 誰でも検索で見つけられる（非推奨）

2. 権限レベルを確認（任意）:
   - ドロップダウンで **「予定の表示（すべての予定の詳細）」** を選択
   - これにより、イベント名、場所、説明が表示されます

3. **カレンダーIDを確認**（下の「カレンダーの統合」セクション）
   - カレンダーID: `xxx@group.calendar.google.com`
   - このIDをメモしてください（アプリで使用します）

**重要**: 
- 「共有可能なリンクを取得」ボタンは**使わなくてOK**です
- カレンダーIDがあれば、`https://calendar.google.com/calendar/render?cid=カレンダーID` のURLで直接追加できます
- アプリの「カレンダーに追加」ボタンも、このカレンダーIDを使用します

**メリット**:
- ✅ 設定が簡単（チェックを外すだけ）
- ✅ カレンダーIDで直接追加可能
- ✅ 検索エンジンには表示されない
- ✅ 公式ヘルプに記載されている方法と同様の動作

#### オプションB: 完全公開（非推奨）

> **参考**: [Googleカレンダーの公式ヘルプ](https://support.google.com/calendar/answer/37082?hl=ja#zippy=%2C%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC%E3%82%92%E4%B8%80%E8%88%AC%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B) によると、一般公開すると以下のことが可能になります：
> - ウェブサイトで表示、検索結果で表示
> - 他のアプリと同期
> - Googleカレンダーで登録

- ☑️ **「一般公開して誰でも利用できるようにする」** にチェック
- 権限: **「予定の表示（時間枠のみ、詳細は非表示）」** または **「予定の表示（すべての予定の詳細）」**

> **警告**: この設定では、検索エンジンでカレンダーが見つかる可能性があります。機密性の高い情報がある場合は使用しないでください。

#### オプションC: 特定のユーザーとのみ共有

> **参考**: [Googleカレンダーの公式ヘルプ](https://support.google.com/calendar/answer/37082?hl=ja) によると、特定のユーザーと共有する場合：
> - ユーザーのメールアドレスを追加
> - アクセス権限を設定（予定の表示、予定の変更など）
> - 共有リクエストのメールが送信される

1. **「特定のユーザーまたはグループと共有する」** セクションで
2. **「ユーザーやグループを追加」** をクリック
3. 各ユーザーのメールアドレスを追加
4. アクセス権限を選択:
   - **「予定の表示（すべての予定の詳細）」** を推奨

> **注意**: この方法は、メンバーごとに個別に共有設定が必要です。メンバーが多い場合は手間がかかります。

### 5. 権限レベルを確認

「アクセス権限」で以下を確認:
- **「予定の表示（すべての予定の詳細）」** が選択されていることを確認
- これにより、イベント名、場所、説明が共有されます

> **参考**: [Googleカレンダーの公式ヘルプ](https://support.google.com/calendar/answer/37082?hl=ja) によると、アクセス権限には以下の種類があります：
> - **予定の表示（時間枠のみ、詳細は非表示）**: 時間枠のみ確認可能
> - **予定の表示（すべての予定の詳細）**: すべての内容を確認可能（推奨）
> - **予定の変更**: 予定を編集可能
> - **予定の変更および共有の管理**: 完全に管理可能

### 6. 設定を保存

- 画面上部の **「完了」** または **「保存」** をクリック（表示される場合）
- 設定は自動的に保存されます

---

## ✅ 設定確認方法

### 方法1: カレンダーIDを確認

1. 「設定と共有」画面で下にスクロール
2. **「カレンダーの統合」** セクションを探す
3. **「カレンダーID」** が表示されています
   - 例: `xxx@group.calendar.google.com`
4. このIDをメモしてください（アプリで使用します）

### 方法2: カレンダー追加をテスト

1. カレンダーIDを取得（「カレンダーの統合」セクション）
2. 以下のURLにアクセス（カレンダーIDを置き換える）:
   ```
   https://calendar.google.com/calendar/render?cid=カレンダーID
   ```
3. Googleカレンダーが開き、カレンダーが追加されることを確認

**例**:
```
https://calendar.google.com/calendar/render?cid=xxx@group.calendar.google.com
```

> **注意**: 「共有可能なリンクを取得」で取得したリンクは、追加の許可が必要な場合があるため、この方法（カレンダーID直接指定）の方が確実です。

---

## 🔄 設定の取り消し方法

カレンダーを非公開に戻す場合:

1. 「設定と共有」画面を開く
2. 「アクセス権限」セクションで
3. ☑️ **「特定のユーザーとのみ共有する」** にチェック
4. これで、指定したユーザーのみが閲覧可能になります

---

## 📊 公開レベルの比較

| 設定方法 | 閲覧可能な人 | 検索 | 推奨度 |
|---------|------------|------|--------|
| 共有リンク方式 | リンクを知っている人 | 不可 | ⭐⭐⭐ 推奨 |
| 特定のユーザーのみ | 指定したユーザーのみ | 不可 | ⭐⭐ |
| 一般公開 | 誰でも | 可能 | ⚠️ 非推奨 |

**推奨**: カレンダーID方式（オプションA）
- 「一般公開」のチェックは外す（これだけでOK）
- カレンダーIDを確認（アプリで使用）
- アプリの「カレンダーに追加」ボタンでカレンダーIDを使って追加

> **補足**: 「共有可能なリンクを取得」ボタンは使わなくてOKです。カレンダーIDがあれば追加できます。

---

## ❓ トラブルシューティング

### カレンダーが見つからない

**原因**: カレンダーが作成されていない、または別のアカウントで作成されている

**対処法**:
1. GASエディタで `setupBandCalendar()` 関数を実行
2. ログを確認してカレンダーIDを取得
3. Configシートの `CALENDAR_ID` を確認

### 設定が反映されない

**原因**: 設定の反映に時間がかかる場合がある

**対処法**:
1. 数分待ってから再度確認
2. ブラウザのキャッシュをクリア
3. 別のブラウザで確認

### 「アクセス権限」が見つからない

**原因**: カレンダーの所有者でない可能性がある

**対処法**:
1. カレンダーを作成したGoogleアカウントでログイン
2. GASスクリプトの実行アカウントを確認

---

## 📝 次のステップ

### 設定が完了したら:

1. ✅ **カレンダーIDを確認・メモ**
   - 「設定と共有」画面の「カレンダーの統合」セクション
   - カレンダーID: `xxx@group.calendar.google.com`

2. ✅ **カレンダーIDを確認**（オプションAの場合）
   - 「設定と共有」画面の「カレンダーの統合」セクションでカレンダーIDを確認
   - アプリの「カレンダーに追加」ボタンは、このカレンダーIDを使用します

3. ✅ **アプリで「カレンダーに追加」ボタンをテスト**
   - ヘッダーの「📅」ボタンをクリック
   - 「Googleカレンダーに追加」ボタンでカレンダーが追加されることを確認

### 重要な注意点

**「一般公開して誰でも利用できるようにする」のチェックは外したまま**にしてください。

- チェックを外す = リンクを知っている人のみがアクセス可能
- チェックを入れる = 誰でも検索で見つけられる（非推奨）

設定完了後、アプリに「カレンダーに追加」ボタンが表示されます。

